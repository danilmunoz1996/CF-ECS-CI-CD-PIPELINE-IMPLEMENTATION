{"version":3,"file":"model.js","names":["Schema","mongoose","name","first","String","last","email","type","unique","lowercase","emailVerified","Boolean","password","phone","number","verified","pre","next","user","bcrypt","genSalt","err","salt","hash","methods","comparedPassword","candidatePassword","cb","compare","good","model"],"sources":["../../src/user/model.js"],"sourcesContent":["import mongoose from 'mongoose';\nimport bcrypt from 'bcrypt-nodejs';\n\n// Define the model\nconst Schema = new mongoose.Schema({\n    name: {\n        first: String,\n        last: String,\n    },\n    email: {\n        type: String,\n        unique: true,\n        lowercase: true\n    },\n    emailVerified: {\n        type: Boolean,\n        default: false\n    },\n    password: String,\n    phone: {\n        number: {\n            type: String\n        },\n        verified: {\n            type: Boolean,\n            default: false\n        }\n    }\n})\n\nSchema.pre('save', function(next){\n    // get access to user model, then we can use user.email, user.password\n    const user = this;\n\n    bcrypt.genSalt(10, function(err, salt){\n        if (err) { return next(err) }\n\n        bcrypt.hash(user.password, salt, null, function(err, hash){\n            if (err) { return next(err); }\n\n            user.password = hash;\n            next()\n        })\n    })\n})\n\n// Make use of methods for comparedPassword\nSchema.methods.comparedPassword = function(candidatePassword, cb) {\n    bcrypt.compare(candidatePassword, this.password, function(err, good){\n        if (err ) { return cb(err)}\n        cb(null, good);\n    })\n}\n\n// Export the model\nexport default mongoose.model('User', Schema);"],"mappings":";;;;;;AAAA;AACA;AAAmC;AAEnC;AACA,IAAMA,MAAM,GAAG,IAAIC,oBAAQ,CAACD,MAAM,CAAC;EAC/BE,IAAI,EAAE;IACFC,KAAK,EAAEC,MAAM;IACbC,IAAI,EAAED;EACV,CAAC;EACDE,KAAK,EAAE;IACHC,IAAI,EAAEH,MAAM;IACZI,MAAM,EAAE,IAAI;IACZC,SAAS,EAAE;EACf,CAAC;EACDC,aAAa,EAAE;IACXH,IAAI,EAAEI,OAAO;IACb,WAAS;EACb,CAAC;EACDC,QAAQ,EAAER,MAAM;EAChBS,KAAK,EAAE;IACHC,MAAM,EAAE;MACJP,IAAI,EAAEH;IACV,CAAC;IACDW,QAAQ,EAAE;MACNR,IAAI,EAAEI,OAAO;MACb,WAAS;IACb;EACJ;AACJ,CAAC,CAAC;AAEFX,MAAM,CAACgB,GAAG,CAAC,MAAM,EAAE,UAASC,IAAI,EAAC;EAC7B;EACA,IAAMC,IAAI,GAAG,IAAI;EAEjBC,wBAAM,CAACC,OAAO,CAAC,EAAE,EAAE,UAASC,GAAG,EAAEC,IAAI,EAAC;IAClC,IAAID,GAAG,EAAE;MAAE,OAAOJ,IAAI,CAACI,GAAG,CAAC;IAAC;IAE5BF,wBAAM,CAACI,IAAI,CAACL,IAAI,CAACN,QAAQ,EAAEU,IAAI,EAAE,IAAI,EAAE,UAASD,GAAG,EAAEE,IAAI,EAAC;MACtD,IAAIF,GAAG,EAAE;QAAE,OAAOJ,IAAI,CAACI,GAAG,CAAC;MAAE;MAE7BH,IAAI,CAACN,QAAQ,GAAGW,IAAI;MACpBN,IAAI,EAAE;IACV,CAAC,CAAC;EACN,CAAC,CAAC;AACN,CAAC,CAAC;;AAEF;AACAjB,MAAM,CAACwB,OAAO,CAACC,gBAAgB,GAAG,UAASC,iBAAiB,EAAEC,EAAE,EAAE;EAC9DR,wBAAM,CAACS,OAAO,CAACF,iBAAiB,EAAE,IAAI,CAACd,QAAQ,EAAE,UAASS,GAAG,EAAEQ,IAAI,EAAC;IAChE,IAAIR,GAAG,EAAG;MAAE,OAAOM,EAAE,CAACN,GAAG,CAAC;IAAA;IAC1BM,EAAE,CAAC,IAAI,EAAEE,IAAI,CAAC;EAClB,CAAC,CAAC;AACN,CAAC;;AAED;AAAA,eACe5B,oBAAQ,CAAC6B,KAAK,CAAC,MAAM,EAAE9B,MAAM,CAAC;AAAA"}