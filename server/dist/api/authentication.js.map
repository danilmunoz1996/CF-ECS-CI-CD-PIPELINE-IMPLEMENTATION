{"version":3,"file":"authentication.js","names":["signup","req","res","next","body","email","password","firstName","lastName","status","send","error","UserModel","findOne","err","existingUser","user","name","first","last","save","savedUser","json","success","token","signin","comparedPassword","good"],"sources":["../../src/api/authentication.js"],"sourcesContent":["import UserModel from '../user/model';\n\nexport default {\n    signup : (req, res, next) => {\n        const { email, password, firstName, lastName } = req.body;\n    \n        if (!email || !password) {\n            return res\n                .status(422)\n                .send({error: 'You must provide email and password.'});\n        }\n        UserModel\n            .findOne({\n                email: email\n            }, function (err, existingUser) {\n                if (err) return res.status(422).send(err);\n                if (existingUser) {\n                    return res\n                        .status(422)\n                        .send({error: 'Email is in use'});\n                }\n                const user = new UserModel({\n                    name: {\n                        first: firstName, \n                        last: lastName\n                    },\n                    email: email,\n                    password: password\n                })\n    \n                user.save(function (err, savedUser) {\n                    if (err) {\n                        return next(err)\n                    }\n    \n                    res.json({\n                        success: true,\n                        token: '1234'\n                    })\n                })\n            })\n    },\n    \n    signin: (req, res, next) => {\n        const email = req.body.email;\n        const password = req.body.password;\n        if (!email || !password) {\n            return res\n                .status(422)\n                .send({error: 'You must provide email and password.'});\n        }\n        UserModel\n            .findOne({\n                email: email\n            }, function (err, existingUser) {\n                if (err || !existingUser) {\n                    return res.status(401).send(err || {error: \"User Not Found\"})\n                }\n                if (existingUser) {\n                    existingUser.comparedPassword(password, function(err, good) {\n                        if (err || !good) {\n                                return res.status(401).send(err || 'User not found')\n                            }\n    \n                            res.send({\n                                token: '1234'\n                            })\n                    })\n                }\n            })\n    }\n}\n"],"mappings":";;;;;;AAAA;AAAsC;AAAA,eAEvB;EACXA,MAAM,EAAG,gBAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAK;IACzB,gBAAiDF,GAAG,CAACG,IAAI;MAAjDC,KAAK,aAALA,KAAK;MAAEC,QAAQ,aAARA,QAAQ;MAAEC,SAAS,aAATA,SAAS;MAAEC,QAAQ,aAARA,QAAQ;IAE5C,IAAI,CAACH,KAAK,IAAI,CAACC,QAAQ,EAAE;MACrB,OAAOJ,GAAG,CACLO,MAAM,CAAC,GAAG,CAAC,CACXC,IAAI,CAAC;QAACC,KAAK,EAAE;MAAsC,CAAC,CAAC;IAC9D;IACAC,iBAAS,CACJC,OAAO,CAAC;MACLR,KAAK,EAAEA;IACX,CAAC,EAAE,UAAUS,GAAG,EAAEC,YAAY,EAAE;MAC5B,IAAID,GAAG,EAAE,OAAOZ,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACI,GAAG,CAAC;MACzC,IAAIC,YAAY,EAAE;QACd,OAAOb,GAAG,CACLO,MAAM,CAAC,GAAG,CAAC,CACXC,IAAI,CAAC;UAACC,KAAK,EAAE;QAAiB,CAAC,CAAC;MACzC;MACA,IAAMK,IAAI,GAAG,IAAIJ,iBAAS,CAAC;QACvBK,IAAI,EAAE;UACFC,KAAK,EAAEX,SAAS;UAChBY,IAAI,EAAEX;QACV,CAAC;QACDH,KAAK,EAAEA,KAAK;QACZC,QAAQ,EAAEA;MACd,CAAC,CAAC;MAEFU,IAAI,CAACI,IAAI,CAAC,UAAUN,GAAG,EAAEO,SAAS,EAAE;QAChC,IAAIP,GAAG,EAAE;UACL,OAAOX,IAAI,CAACW,GAAG,CAAC;QACpB;QAEAZ,GAAG,CAACoB,IAAI,CAAC;UACLC,OAAO,EAAE,IAAI;UACbC,KAAK,EAAE;QACX,CAAC,CAAC;MACN,CAAC,CAAC;IACN,CAAC,CAAC;EACV,CAAC;EAEDC,MAAM,EAAE,gBAACxB,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAK;IACxB,IAAME,KAAK,GAAGJ,GAAG,CAACG,IAAI,CAACC,KAAK;IAC5B,IAAMC,QAAQ,GAAGL,GAAG,CAACG,IAAI,CAACE,QAAQ;IAClC,IAAI,CAACD,KAAK,IAAI,CAACC,QAAQ,EAAE;MACrB,OAAOJ,GAAG,CACLO,MAAM,CAAC,GAAG,CAAC,CACXC,IAAI,CAAC;QAACC,KAAK,EAAE;MAAsC,CAAC,CAAC;IAC9D;IACAC,iBAAS,CACJC,OAAO,CAAC;MACLR,KAAK,EAAEA;IACX,CAAC,EAAE,UAAUS,GAAG,EAAEC,YAAY,EAAE;MAC5B,IAAID,GAAG,IAAI,CAACC,YAAY,EAAE;QACtB,OAAOb,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACI,GAAG,IAAI;UAACH,KAAK,EAAE;QAAgB,CAAC,CAAC;MACjE;MACA,IAAII,YAAY,EAAE;QACdA,YAAY,CAACW,gBAAgB,CAACpB,QAAQ,EAAE,UAASQ,GAAG,EAAEa,IAAI,EAAE;UACxD,IAAIb,GAAG,IAAI,CAACa,IAAI,EAAE;YACV,OAAOzB,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACI,GAAG,IAAI,gBAAgB,CAAC;UACxD;UAEAZ,GAAG,CAACQ,IAAI,CAAC;YACLc,KAAK,EAAE;UACX,CAAC,CAAC;QACV,CAAC,CAAC;MACN;IACJ,CAAC,CAAC;EACV;AACJ,CAAC;AAAA"}